<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Number line worksheet maker</title>
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --ink:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;

      /* Levels (now 1–5) */
      --lvl1:#16a34a; --lvl1Soft:#dcfce7;  /* Sweet (green) */
      --lvl2:#2563eb; --lvl2Soft:#dbeafe;  /* Mild (blue) */
      --lvl3:#f59e0b; --lvl3Soft:#fef9c3;  /* Medium (amber) */
      --lvl4:#f97316; --lvl4Soft:#ffedd5;  /* Spicy (orange) */
      --lvl5:#ef4444; --lvl5Soft:#fee2e2;  /* Extra hot (red) */

      --line:#1f2937;
      --dot:#111827;

      --box:#0f172a;
      --ans:#16a34a;

      --shadow:0 10px 25px rgba(0,0,0,.08);
      --radius:18px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:var(--bg);
      color:var(--ink);
    }
    .wrap{
      max-width: 1200px;
      margin: 18px auto 40px;
      padding: 0 16px;
    }
    .card{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
    }

    h1{ margin:0; font-size:20px; font-weight:950; letter-spacing:.2px; }
    .sub{ margin-top:6px; font-size:13px; font-weight:800; color:var(--muted); }

    .controls{
      margin-top:14px;
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      align-items:flex-end;
      padding:12px;
      border:1px solid var(--border);
      border-radius:16px;
      background:linear-gradient(180deg,#fff,#f9fafb);
    }

    label{
      font-size:12px;
      font-weight:900;
      color:#374151;
      display:block;
      margin-bottom:6px;
    }
    select, input[type="number"]{
      width: 220px;
      padding:10px 10px;
      border-radius:12px;
      border:2px solid var(--border);
      font-weight:900;
      outline:none;
      background:#fff;
    }
    input[type="number"]{ width: 140px; }

    button{
      border:none;
      border-radius:12px;
      padding:10px 14px;
      font-weight:950;
      cursor:pointer;
      background:#f3f4f6;
      color:#111827;
      user-select:none;
    }
    button.primary{ background:#2563eb; color:#fff; }
    button.danger{ background:#fee2e2; color:#991b1b; }
    button:disabled{ opacity:.5; cursor:not-allowed; }

    .actions{
      margin-left:auto;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .preview{
      margin-top:14px;
      border:1px solid var(--border);
      border-radius:16px;
      background:#fff;
      overflow:hidden;
    }
    .pages{ padding: 16px; }

    .page{
      border:1px solid var(--border);
      border-radius:14px;
      padding: 10px;
      margin: 0 0 18px;
      background: #fff;
    }

    /* Brand line */
    .pageBrandRow{
      display:flex;
      align-items:center;
      gap:8px;
      margin: 2px 0 6px;
      color:#111827;
      font-weight:950;
      font-size:12px;
    }
    .pageBrandRow img{
      height: 14px;
      width: auto;
      display:block;
    }
    .pageBrandRow a{
      color:#111827;
      text-decoration:none;
    }
    .pageBrandRow a:hover{ text-decoration:underline; }

    /* Title + page number row */
    .pageHeaderRow{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:10px;
      margin: 0 0 6px;
    }
    .pageHeaderTitle{
      font-weight:950;
      font-size:14px;
      margin:0;
      color:#111827;
      letter-spacing:.15px;
    }
    .pageNum{
      font-weight:950;
      font-size:12px;
      color:#111827;
      margin:0;
    }

    /* Name/Date row */
    .pageMetaRow{
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      align-items:flex-end;
      padding-bottom:8px;
      border-bottom: 1px solid #111827;
      margin-bottom: 10px;
      font-weight:900;
      font-size:12px;
      color:#111827;
    }
    .lineBlank{
      display:inline-block;
      min-width: 160px;
      border-bottom: 2px solid #111827;
      transform: translateY(-2px);
      margin-left:6px;
    }

    /* 2 columns */
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .qcard{
      border:1px solid var(--border);
      border-radius:12px;
      padding: 6px 8px 6px;
      background: #fff;
      position:relative;
      min-height: 135px;
    }
    .qnum{
      position:absolute;
      top: 6px;
      left: 8px;
      font-weight:950;
      font-size:11px;
      color:#6b7280;
    }
    .qprompt{
      text-align:center;
      font-weight:950;
      font-size:12px;
      margin: 0 0 4px;
      color:#111827;
    }

    .qrow{
      display:flex;
      gap: 10px;
      align-items:center;
      justify-content:space-between;
    }

    .svgBox{ flex: 1 1 auto; }
    svg{
      width:100%;
      height: 92px;
      display:block;
    }

    .answerSide{
      flex: 0 0 60px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:6px;
      font-weight:950;
      color:#111827;
    }
    .ansSquare{
      width: 32px;
      height: 32px;
      border:2px solid #111827;
      border-radius:6px;
      background:#fff;
    }

    @media print{
      body{ background:#fff; }
      .wrap{ max-width:none; margin:0; padding:0; }
      .card{ box-shadow:none; border-radius:0; padding:0; }

      .topUi{ display:none !important; }
      .controls, .sub{ display:none !important; }
      .preview{ border:none; border-radius:0; }
      .pages{ padding: 0; }

      .page{
        border:none; border-radius:0;
        padding: 0 0 3mm;
        margin: 0;
        display:flex;
        flex-direction:column;
        page-break-after: always;
      }
      .page:last-child{ page-break-after: auto; }

      /* ✅ Your working print margins */
      @page{ size: A4; margin: 18mm; }

      .pageBrandRow{ margin: 0 0 3mm; font-size: 11px; }
      .pageHeaderTitle{ font-size: 13px; }
      .pageMetaRow{ padding-bottom: 4mm; margin-bottom: 5mm; }

      .grid{
        flex: 1;
        gap: 5mm 7mm;
        align-content: start;
      }

      .qcard{
        border:1px solid #000;
        border-radius:10px;
        padding: 3.6mm 4mm 3mm;
        min-height: 42mm;
      }

      svg{ height: 26mm; }

      .ansSquare{ border:2px solid #000; width: 10mm; height: 10mm; }
      .answerSide{ flex-basis: 18mm; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="topUi">
        <h1>Number line worksheet maker</h1>
        <div class="sub">Printable A4 worksheets + completed answer key. 10 questions per page (2×5).</div>
      </div>

      <div class="controls" id="setup">
        <div>
          <label for="levelSel">Level</label>
          <select id="levelSel">
            <option value="1">Level 1 Sweet</option>
            <option value="2">Level 2 Mild</option>
            <option value="3">Level 3 Medium</option>
            <option value="4">Level 4 Spicy</option>
            <option value="5">Level 5 Extra hot</option>
          </select>
        </div>

        <div>
          <label for="numQ">Number of questions (1–48)</label>
          <input id="numQ" type="number" min="1" max="48" value="20" />
        </div>

        <div class="actions">
          <button id="genBtn" class="primary">Generate worksheet</button>
          <button id="printBtn" disabled>Print (Ctrl+P)</button>
          <button id="clearBtn" class="danger" disabled>Reset</button>
        </div>
      </div>

      <div class="preview" id="preview" style="display:none;">
        <div class="pages" id="pages"></div>
      </div>
    </div>
  </div>

<script>
(() => {
  // =========================
  // Scaled-by-2 numbers (supports halves cleanly)
  // =========================
  const toS2 = (n) => Math.round(n * 2);
  const fmtS2 = (s2) => {
    if (s2 % 2 === 0) return String(s2/2);
    const sign = s2 < 0 ? "-" : "";
    const abs = Math.abs(s2);
    const whole = Math.floor(abs/2);
    return `${sign}${whole}.5`;
  };

  const randInt = (a,b) => Math.floor(Math.random()*(b-a+1))+a;
  const choice = (arr) => arr[randInt(0, arr.length-1)];

  const TICKS = 7;
  const MID_INDEX = 3; // for 7 ticks
  const PAGE_COUNT = 10;

  // Levels updated:
  // 1 Sweet (fixed step 1, midpoint -20..20)
  // 2 Mild  (old L1)
  // 3 Medium(old L2)
  // 4 Spicy (old L3)
  // 5 Extra hot (old L4)
  const LEVELS = {
    1: { name:"Level 1 Sweet",   midMin:-20,  midMax:20,  fixedStep:1 },
    2: { name:"Level 2 Mild",    midMin:-10,  midMax:5,   stepsFirstHalf:[1], stepsSecondHalf:[1,2] },
    3: { name:"Level 3 Medium",  midMin:-100, midMax:50,  stepsAll:[1,2,5,10] },
    4: { name:"Level 4 Spicy",   midMin:-200, midMax:100, stepsAll:[1,2,3,4,5,10] },
    5: { name:"Level 5 Extra hot", midMin:-200, midMax:100, stepsAll:[0.5,1,1.5,2,2.5,3,3.5,4,4.5,5,10] }
  };

  // =========================
  // ✅ "Ideal" display tuning (easy to tweak)
  // =========================
  const SVG_W = 620;              // was 600 (more breathing room at ends)
  const SVG_H = 120;
  const SVG_PAD = 26;             // bigger left/right inset prevents end clipping
  const LABEL_FONT_STUDENT = 23;  // balanced vs your screenshot
  const LABEL_FONT_KEY = 22;
  const ANSWER_FONT_KEY = 24;
  const QMARK_FONT = 22;

  const BOX_W = 48;
  const BOX_H = 30;
  const BOX_EDGE_PAD = 6;         // keeps ? box inside viewbox if target at an end

  function isNiceAnchorS2(s2){
    if (s2 % 2 !== 0) return false;
    const v = s2/2;
    const av = Math.abs(v);
    if (av >= 100) return v % 100 === 0 || v % 10 === 0;
    if (av >= 10) return v % 10 === 0;
    return true;
  }

  function pickAnchors(valuesS2, targetIndex){
    const pairs = [];
    for (let i=0; i<TICKS-1; i++){
      if (i === targetIndex) continue;
      if (i+1 === targetIndex) continue;
      const v1 = valuesS2[i], v2 = valuesS2[i+1];
      let score = 0;
      if (isNiceAnchorS2(v1)) score += 2;
      if (isNiceAnchorS2(v2)) score += 2;
      pairs.push({i, score});
    }
    pairs.sort((a,b)=>b.score-a.score);
    const best = pairs.length ? pairs[0].score : 0;
    const topPairs = pairs.filter(p=>p.score===best);
    const pair = topPairs.length ? choice(topPairs) : {i: randInt(0, TICKS-2)};
    const a = pair.i, b = pair.i+1;

    const farCands = [];
    for (let j=0; j<TICKS; j++){
      if (j === targetIndex) continue;
      if (j === a || j === b) continue;
      const v = valuesS2[j];
      let score = 0;
      if (isNiceAnchorS2(v)) score += 3;
      score += Math.abs(j - a) * 0.25;
      farCands.push({j, score});
    }
    farCands.sort((x,y)=>y.score-x.score);
    const bestFar = farCands.length ? farCands[0].score : 0;
    const topFar = farCands.filter(c=>c.score===bestFar);
    const far = topFar.length ? choice(topFar).j : randInt(0, TICKS-1);

    return new Set([a,b,far]);
  }

  function lineHasNegative(valuesS2){
    return valuesS2.some(v => v < 0);
  }

  function sig(q){
    return `${q.midS2}|${q.stepS2}|${q.targetIndex}`;
  }

  function generateQuestions(level, n){
    const cfg = LEVELS[level];
    const halfNegNeeded = Math.ceil(n/2);

    const out = [];
    const seen = new Set();

    let attempts = 0;
    while (out.length < n && attempts < 50000){
      attempts++;

      const idx = out.length;
      const mustBeNegative = (idx < halfNegNeeded);

      // pick step
      let step;
      if (cfg.fixedStep != null){
        step = cfg.fixedStep; // Sweet always step 1
      } else if (level === 2){
        const firstHalf = Math.ceil(n/2);
        step = (idx < firstHalf) ? choice(cfg.stepsFirstHalf) : choice(cfg.stepsSecondHalf);
      } else {
        step = choice(cfg.stepsAll);
      }
      const stepS2 = toS2(step);

      const midInt = randInt(cfg.midMin, cfg.midMax);
      const midS2 = midInt * 2;

      const startS2 = midS2 - MID_INDEX * stepS2;
      const valuesS2 = Array.from({length:TICKS}, (_,i)=> startS2 + i*stepS2);

      if (mustBeNegative && !lineHasNegative(valuesS2)) continue;

      const targetIndex = randInt(0, TICKS-1);

      const anchors = pickAnchors(valuesS2, targetIndex);
      if (anchors.has(targetIndex)) continue;
      if (anchors.size !== 3) continue;

      const q = { midS2, stepS2, valuesS2, targetIndex, anchors };
      const s = sig(q);
      if (seen.has(s)) continue;
      seen.add(s);

      out.push(q);
    }

    while (out.length < n){
      const idx = out.length;
      const mustBeNegative = (idx < Math.ceil(n/2));

      let step;
      if (cfg.fixedStep != null){
        step = cfg.fixedStep;
      } else if (level === 2){
        const firstHalf = Math.ceil(n/2);
        step = (idx < firstHalf) ? 1 : choice([1,2]);
      } else {
        step = choice(cfg.stepsAll);
      }
      const stepS2 = toS2(step);

      let midS2 = randInt(cfg.midMin, cfg.midMax) * 2;
      let startS2 = midS2 - MID_INDEX * stepS2;
      let valuesS2 = Array.from({length:TICKS}, (_,i)=> startS2 + i*stepS2);

      if (mustBeNegative && !lineHasNegative(valuesS2)){
        midS2 -= (Math.abs(valuesS2[0]) + 2);
        startS2 = midS2 - MID_INDEX * stepS2;
        valuesS2 = Array.from({length:TICKS}, (_,i)=> startS2 + i*stepS2);
      }

      const targetIndex = randInt(0, TICKS-1);
      const anchors = pickAnchors(valuesS2, targetIndex);
      if (anchors.has(targetIndex)) continue;

      const q = { midS2, stepS2, valuesS2, targetIndex, anchors };
      const s = sig(q);
      if (out.some(qq => sig(qq) === s)) continue;

      out.push(q);
    }

    return out;
  }

  function computeTotalPages(totalItems){
    if (totalItems <= 0) return 0;
    return Math.ceil(totalItems / PAGE_COUNT);
  }

  function sliceForPage(items, pageNum){
    const start = (pageNum - 1) * PAGE_COUNT;
    const end = Math.min(start + PAGE_COUNT, items.length);
    return { start, end, count: Math.max(0, end - start) };
  }

  function makeSVGQuestion(q, mode){
    const showAllLabels = (mode === "key");

    const W = SVG_W, H = SVG_H;
    const left = SVG_PAD, right = W - SVG_PAD;
    const yLine = 42;
    const tickTop = yLine - 11, tickBot = yLine + 11;
    const labelY = 96;

    const x = (i) => left + (right-left) * (i/(TICKS-1));
    const ns = "http://www.w3.org/2000/svg";
    const svg = document.createElementNS(ns, "svg");
    svg.setAttribute("viewBox", `0 0 ${W} ${H}`);

    const line = document.createElementNS(ns, "line");
    line.setAttribute("x1", left);
    line.setAttribute("y1", yLine);
    line.setAttribute("x2", right);
    line.setAttribute("y2", yLine);
    line.setAttribute("stroke", "var(--line)");
    line.setAttribute("stroke-width", "3.5");
    line.setAttribute("stroke-linecap", "round");
    svg.appendChild(line);

    for (let i=0;i<TICKS;i++){
      const xi = x(i);

      const t = document.createElementNS(ns, "line");
      t.setAttribute("x1", xi);
      t.setAttribute("y1", tickTop);
      t.setAttribute("x2", xi);
      t.setAttribute("y2", tickBot);
      t.setAttribute("stroke", "var(--line)");
      t.setAttribute("stroke-width", "3.5");
      t.setAttribute("stroke-linecap", "round");
      svg.appendChild(t);

      const c = document.createElementNS(ns, "circle");
      c.setAttribute("cx", xi);
      c.setAttribute("cy", yLine);
      c.setAttribute("r", "5.2");
      c.setAttribute("fill", "var(--dot)");
      c.setAttribute("opacity", ".65");
      svg.appendChild(c);
    }

    const shouldLabel = (i) => showAllLabels ? true : q.anchors.has(i);

    // Labels
    for (let i=0;i<TICKS;i++){
      if (!showAllLabels && i === q.targetIndex) continue;
      if (!shouldLabel(i)) continue;

      const txt = document.createElementNS(ns, "text");
      txt.textContent = fmtS2(q.valuesS2[i]);

      // end-safe anchoring
      let anchor = "middle";
      let xi = x(i);
      if (i === 0) { anchor = "start"; xi = left; }
      if (i === TICKS-1) { anchor = "end"; xi = right; }

      txt.setAttribute("x", xi);
      txt.setAttribute("y", labelY);
      txt.setAttribute("text-anchor", anchor);
      txt.setAttribute("font-size", String(showAllLabels ? LABEL_FONT_KEY : LABEL_FONT_STUDENT));
      txt.setAttribute("font-weight", "950");
      txt.setAttribute("fill", "#374151");
      svg.appendChild(txt);
    }

    // Missing/answer at target
    const rawTx = x(q.targetIndex);

    const boxW = BOX_W, boxH = BOX_H;
    const boxY = labelY - 26;
    const unclampedX = rawTx - boxW/2;
    const boxX = Math.max(BOX_EDGE_PAD, Math.min(W - boxW - BOX_EDGE_PAD, unclampedX));
    const tx = boxX + boxW/2;

    if (!showAllLabels){
      const rect = document.createElementNS(ns, "rect");
      rect.setAttribute("x", boxX);
      rect.setAttribute("y", boxY);
      rect.setAttribute("width", boxW);
      rect.setAttribute("height", boxH);
      rect.setAttribute("rx", "10");
      rect.setAttribute("fill", "var(--box)");
      svg.appendChild(rect);

      const qm = document.createElementNS(ns, "text");
      qm.textContent = "?";
      qm.setAttribute("x", tx);
      qm.setAttribute("y", boxY + 22);
      qm.setAttribute("text-anchor", "middle");
      qm.setAttribute("font-size", String(QMARK_FONT));
      qm.setAttribute("font-weight", "950");
      qm.setAttribute("fill", "#ffffff");
      svg.appendChild(qm);
    } else {
      const ans = document.createElementNS(ns, "text");
      ans.textContent = fmtS2(q.valuesS2[q.targetIndex]);
      ans.setAttribute("x", rawTx);
      ans.setAttribute("y", labelY);
      ans.setAttribute("text-anchor", "middle");
      ans.setAttribute("font-size", String(ANSWER_FONT_KEY));
      ans.setAttribute("font-weight", "950");
      ans.setAttribute("fill", "var(--ans)");
      svg.appendChild(ans);
    }

    return svg;
  }

  function makeQuestionCard(q, qIndex, mode){
    const qc = document.createElement('div');
    qc.className = 'qcard';

    const qn = document.createElement('div');
    qn.className = 'qnum';
    qn.textContent = `Q${qIndex+1}`;
    qc.appendChild(qn);

    const prompt = document.createElement('div');
    prompt.className = 'qprompt';
    prompt.textContent = "What is the missing value?";
    qc.appendChild(prompt);

    const row = document.createElement('div');
    row.className = 'qrow';

    const svgBox = document.createElement('div');
    svgBox.className = 'svgBox';
    svgBox.appendChild(makeSVGQuestion(q, mode));

    const ansSide = document.createElement('div');
    ansSide.className = 'answerSide';

    const eq = document.createElement('div');
    eq.textContent = "=";
    eq.style.fontSize = "16px";

    const sq = document.createElement('div');
    sq.className = 'ansSquare';

    if (mode === "key"){
      sq.style.display = "flex";
      sq.style.alignItems = "center";
      sq.style.justifyContent = "center";
      sq.style.fontWeight = "950";
      sq.style.color = "var(--ans)";
      sq.style.borderColor = "var(--ans)";
      sq.style.fontSize = "18px";
      sq.textContent = fmtS2(q.valuesS2[q.targetIndex]);
    }

    ansSide.appendChild(eq);
    ansSide.appendChild(sq);

    row.appendChild(svgBox);
    row.appendChild(ansSide);

    qc.appendChild(row);
    return qc;
  }

  function makeBrandRow(){
    const row = document.createElement('div');
    row.className = "pageBrandRow";

    const img = document.createElement('img');
    img.src = "mmt.png";
    img.alt = "MMT";

    const a = document.createElement('a');
    a.href = "https://www.millsmathstools.au";
    a.target = "_blank";
    a.rel = "noopener noreferrer";
    a.textContent = "www.millsmathstools.au";

    row.appendChild(img);
    row.appendChild(a);
    return row;
  }

  function makeWorksheetHeaderRow(titleText, pageText){
    const row = document.createElement('div');
    row.className = "pageHeaderRow";

    const title = document.createElement('p');
    title.className = "pageHeaderTitle";
    title.textContent = titleText;

    const page = document.createElement('p');
    page.className = "pageNum";
    page.textContent = pageText;

    row.appendChild(title);
    row.appendChild(page);
    return row;
  }

  function makeMetaRow(){
    const row = document.createElement('div');
    row.className = "pageMetaRow";

    const name = document.createElement('span');
    name.innerHTML = `Name:<span class="lineBlank"></span>`;

    const date = document.createElement('span');
    date.innerHTML = `Date:<span class="lineBlank" style="min-width:120px;"></span>`;

    row.appendChild(name);
    row.appendChild(date);

    return row;
  }

  function buildSectionPages(container, titleText, questions, mode, levelName){
    const totalPages = Math.ceil(questions.length / PAGE_COUNT);

    for (let p=1; p<=totalPages; p++){
      const start = (p - 1) * PAGE_COUNT;
      const end = Math.min(start + PAGE_COUNT, questions.length);
      const pageQs = questions.slice(start, end);

      const page = document.createElement('div');
      page.className = 'page';

      page.appendChild(makeBrandRow());

      const baseTitle = (mode === "key") ? "Answer key (completed version)" : titleText;
      const titleForPage = `${baseTitle} \u2013 ${levelName}`;

      page.appendChild(makeWorksheetHeaderRow(titleForPage, `Page ${p} of ${totalPages}`));
      page.appendChild(makeMetaRow());

      const grid = document.createElement('div');
      grid.className = 'grid';

      for (let i=0; i<pageQs.length; i++){
        const qIndex = start + i;
        grid.appendChild(makeQuestionCard(pageQs[i], qIndex, mode));
      }

      page.appendChild(grid);
      container.appendChild(page);
    }
  }

  const levelSel = document.getElementById('levelSel');
  const numQ = document.getElementById('numQ');
  const genBtn = document.getElementById('genBtn');
  const printBtn = document.getElementById('printBtn');
  const clearBtn = document.getElementById('clearBtn');

  const preview = document.getElementById('preview');
  const pagesEl = document.getElementById('pages');

  function clampN(){
    let v = parseInt(numQ.value, 10);
    if (isNaN(v)) v = 20;
    v = Math.max(1, Math.min(48, v));
    numQ.value = v;
    return v;
  }

  function renderWorksheet(level, n){
    pagesEl.innerHTML = "";
    const qs = generateQuestions(level, n);
    const levelName = (LEVELS[level] && LEVELS[level].name) ? LEVELS[level].name : "Level";

    buildSectionPages(pagesEl, "Number line practice", qs, "student", levelName);

    const spacer = document.createElement('div');
    spacer.style.height = "18px";
    pagesEl.appendChild(spacer);

    const keyWrap = document.createElement('div');
    keyWrap.style.marginTop = "18px";
    buildSectionPages(keyWrap, "Number line practice", qs, "key", levelName);
    pagesEl.appendChild(keyWrap);
  }

  genBtn.addEventListener('click', () => {
    const lvl = parseInt(levelSel.value, 10);
    const n = clampN();

    preview.style.display = "block";
    renderWorksheet(lvl, n);

    printBtn.disabled = false;
    clearBtn.disabled = false;

    preview.scrollIntoView({behavior:"smooth", block:"start"});
  });

  printBtn.addEventListener('click', () => window.print());

  clearBtn.addEventListener('click', () => {
    pagesEl.innerHTML = "";
    preview.style.display = "none";
    printBtn.disabled = true;
    clearBtn.disabled = true;
    numQ.value = 20;
  });

  numQ.addEventListener('change', clampN);
})();
</script>
</body>
</html>
